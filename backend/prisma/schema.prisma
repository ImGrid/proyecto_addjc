// Schema Prisma para Sistema ADDJC (Judo Training Management)
// Fecha: 2025-12-16
// Total entidades: 18 tablas
// Basado en: docs/analisis_entidades_base_datos.md

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// ===================================
// ENUMS
// ===================================

enum RolUsuario {
  ADMINISTRADOR
  COMITE_TECNICO
  ENTRENADOR
  ATLETA
}

enum CategoriaPeso {
  MENOS_60K // -60k
  MENOS_66K // -66k
  MENOS_73K // -73k
  MENOS_81K // -81k
  MENOS_90K // -90k
  MENOS_100K // -100k
  MAS_100K // +100k
}

enum EstadoMacrociclo {
  PLANIFICADO
  EN_CURSO
  COMPLETADO
  CANCELADO
}

enum EtapaMesociclo {
  PREPARACION_GENERAL
  PREPARACION_ESPECIFICA
  COMPETITIVA
  TRANSICION
}

enum TipoMicrociclo {
  CARGA
  DESCARGA
  CHOQUE
  RECUPERACION
  COMPETITIVO
}

enum SentidoCarga {
  ASCENDENTE
  DESCENDENTE
  MANTENIMIENTO
}

enum CreadoPor {
  COMITE_TECNICO
  SISTEMA_ALGORITMO
}

enum DiaSemana {
  LUNES
  MARTES
  MIERCOLES
  JUEVES
  VIERNES
  SABADO
  DOMINGO
}

enum TipoSesion {
  ENTRENAMIENTO
  TEST
  RECUPERACION
  DESCANSO
  COMPETENCIA
}

enum Turno {
  MANANA
  TARDE
  COMPLETO
}

enum TipoPlanificacion {
  INICIAL
  AJUSTE_AUTOMATICO
}

enum TipoRecomendacion {
  INICIAL
  AJUSTE_POST_TEST
  ALERTA_FATIGA
  AJUSTE_LESION
  ALERTA_DESVIACION_CARGA
  PERSONALIZACION_TACTICA
  NUTRICIONAL
  AJUSTE_PLANIFICACION
}

enum Prioridad {
  BAJA
  MEDIA
  ALTA
  CRITICA
}

enum EstadoRecomendacion {
  PENDIENTE
  EN_PROCESO
  CUMPLIDA
  RECHAZADA
}

enum TipoNotificacion {
  RECOMENDACION_ALGORITMO
  ALERTA_FATIGA
  ALERTA_LESION
  PLANIFICACION_APROBADA
  PLANIFICACION_MODIFICADA
  SESION_PROXIMA
  TEST_PENDIENTE
  OTRO
}

enum TipoLesion {
  MOLESTIA
  DOLOR_AGUDO
  LESION_CRONICA
  OTRO
}

enum TipoAlerta {
  BAJO_RENDIMIENTO
  PESO_FUERA_RANGO
  LESION_DETECTADA
  TEST_FALLIDO
  FATIGA_ALTA
  DESVIACION_CARGA
}

enum Severidad {
  BAJA
  MEDIA
  ALTA
  CRITICA
}

enum PeriodoTolerancia {
  GENERAL
  ESPECIFICA_I
  ESPECIFICA_II
  PRE_COMPETITIVA
  COMPETITIVA
}

enum TipoEjercicio {
  FISICO
  TECNICO_TACHI
  TECNICO_NE
  RESISTENCIA
  VELOCIDAD
}

// ===================================
// GRUPO 1: USUARIOS Y ROLES
// ===================================

model Usuario {
  id             BigInt     @id @default(autoincrement())
  ci             String     @unique @db.VarChar(20)
  nombreCompleto String     @db.VarChar(255)
  email          String     @unique @db.VarChar(255)
  contrasena     String     @db.VarChar(255)
  rol            RolUsuario
  estado         Boolean    @default(true)
  fechaRegistro  DateTime   @default(now())
  ultimoAcceso   DateTime?
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt

  // Relaciones
  atleta                   Atleta?
  entrenador               Entrenador?
  resetPasswords           ResetPassword[]
  auditorias               AuditoriaAcceso[]
  notificaciones           Notificacion[]
  macrociclosCreados       Macrociclo[]
  asignacionesRealizadas   AsignacionAtletaMicrociclo[]
  recomendacionesRevisadas Recomendacion[]              @relation("RecomendacionRevisada")
  recomendacionesAplicadas Recomendacion[]              @relation("RecomendacionAplicada")
  alertasRecibidas         AlertaSistema[]

  @@index([email])
  @@index([ci])
  @@index([rol])
  @@index([estado])
  @@map("usuarios")
}

model Atleta {
  id                   BigInt   @id @default(autoincrement())
  usuarioId            BigInt   @unique
  municipio            String   @db.VarChar(100)
  club                 String   @db.VarChar(100)
  categoria            String   @db.VarChar(50)
  fechaNacimiento      DateTime @db.Date
  edad                 Int
  direccion            String?  @db.Text
  telefono             String?  @db.VarChar(50)
  entrenadorAsignadoId BigInt?

  // Nuevos campos (excel27-29, audio.txt)
  categoriaPeso CategoriaPeso
  pesoActual    Decimal?       @db.Decimal(5, 2)
  fcReposo      Int?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relaciones
  usuario                    Usuario                      @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
  entrenadorAsignado         Entrenador?                  @relation(fields: [entrenadorAsignadoId], references: [id])
  testsFisicos               TestFisico[]
  registrosPostEntrenamiento RegistroPostEntrenamiento[]
  asignacionesMicrociclos    AsignacionAtletaMicrociclo[]
  recomendaciones            Recomendacion[]
  alertas                    AlertaSistema[]

  @@index([usuarioId])
  @@index([entrenadorAsignadoId])
  @@index([club])
  @@index([categoria])
  @@index([categoriaPeso])
  @@map("atletas")
}

model Entrenador {
  id           BigInt   @id @default(autoincrement())
  usuarioId    BigInt   @unique
  municipio    String   @db.VarChar(100)
  especialidad String?  @db.VarChar(100)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  // Relaciones
  usuario                    Usuario                     @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
  atletasAsignados           Atleta[]
  testsRegistrados           TestFisico[]
  registrosPostEntrenamiento RegistroPostEntrenamiento[]
  dolenciasRecuperadas       Dolencia[]                  @relation("DolenciaRecuperacion")

  @@index([usuarioId])
  @@map("entrenadores")
}

// ===================================
// GRUPO 2: PLANIFICACIÓN DEPORTIVA
// ===================================

model Macrociclo {
  id                BigInt           @id @default(autoincrement())
  nombre            String           @db.VarChar(100)
  temporada         String           @db.VarChar(50)
  equipo            String           @db.VarChar(100)
  categoriaObjetivo String           @db.VarChar(50)
  objetivo1         String           @db.Text
  objetivo2         String           @db.Text
  objetivo3         String           @db.Text
  fechaInicio       DateTime         @db.Date
  fechaFin          DateTime         @db.Date
  estado            EstadoMacrociclo
  totalMicrociclos  Int
  totalSesiones     Int
  totalHoras        Decimal          @db.Decimal(10, 2)
  creadoPor         BigInt
  createdAt         DateTime         @default(now())
  updatedAt         DateTime         @updatedAt

  // Relaciones
  creador    Usuario     @relation(fields: [creadoPor], references: [id])
  mesociclos Mesociclo[]

  @@index([estado])
  @@index([creadoPor])
  @@map("macrociclos")
}

model Mesociclo {
  id               BigInt         @id @default(autoincrement())
  macrocicloId     BigInt
  nombre           String         @db.VarChar(100)
  numeroMesociclo  Int
  etapa            EtapaMesociclo
  fechaInicio      DateTime       @db.Date
  fechaFin         DateTime       @db.Date
  objetivoFisico   String         @db.Text
  objetivoTecnico  String         @db.Text
  objetivoTactico  String         @db.Text
  totalMicrociclos Int
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt

  // Relaciones
  macrociclo  Macrociclo   @relation(fields: [macrocicloId], references: [id], onDelete: Cascade)
  microciclos Microciclo[]

  @@index([macrocicloId])
  @@map("mesociclos")
}

model Microciclo {
  id                     BigInt         @id @default(autoincrement())
  mesocicloId            BigInt?
  numeroMicrociclo       Int?
  numeroGlobalMicrociclo Int
  fechaInicio            DateTime       @db.Date
  fechaFin               DateTime       @db.Date
  tipoMicrociclo         TipoMicrociclo
  volumenTotal           Decimal        @db.Decimal(10, 2)
  intensidadPromedio     Decimal        @db.Decimal(5, 2)
  objetivoSemanal        String         @db.Text
  observaciones          String?        @db.Text

  // Campos de carga (planBD.txt, audio.txt)
  creadoPor         CreadoPor     @default(COMITE_TECNICO)
  mediaVolumen      Decimal?      @db.Decimal(5, 2)
  mediaIntensidad   Decimal?      @db.Decimal(5, 2)
  sentidoVolumen    SentidoCarga?
  sentidoIntensidad SentidoCarga?

  // Campos de cargas semanales (planBD.txt)
  vCarga1      Decimal? @db.Decimal(5, 2)
  vCarga1Nivel Int?     @db.SmallInt
  iCarga1      Decimal? @db.Decimal(5, 2)
  iCarga1Nivel Int?     @db.SmallInt
  vCarga2      Decimal? @db.Decimal(5, 2)
  vCarga2Nivel Int?     @db.SmallInt
  iCarga2      Decimal? @db.Decimal(5, 2)
  iCarga2Nivel Int?     @db.SmallInt

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relaciones
  mesociclo           Mesociclo?                   @relation(fields: [mesocicloId], references: [id])
  sesiones            Sesion[]
  asignacionesAtletas AsignacionAtletaMicrociclo[]
  recomendaciones     Recomendacion[]
  testsFisicos        TestFisico[]

  @@index([mesocicloId])
  @@index([fechaInicio])
  @@map("microciclos")
}

model Sesion {
  id           BigInt     @id @default(autoincrement())
  microcicloId BigInt
  fecha        DateTime   @db.Date
  diaSemana    DiaSemana
  numeroSesion Int
  tipoSesion   TipoSesion

  // Nuevos campos (excel30.PNG, audio.txt)
  turno             Turno             @default(COMPLETO)
  tipoPlanificacion TipoPlanificacion @default(INICIAL)
  sesionBaseId      BigInt?
  creadoPor         CreadoPor         @default(COMITE_TECNICO)

  // Planificación
  duracionPlanificada   Int
  volumenPlanificado    Int
  intensidadPlanificada Int
  fcObjetivo            Int?
  relacionVI            String @db.VarChar(20)

  // Zona de esfuerzo (planBD.txt - nuevo descubrimiento)
  zonaEsfuerzo String? @db.VarChar(50)

  // Datos reales (después de ejecución)
  duracionReal   Int?
  volumenReal    Int?
  intensidadReal Int?

  // Contenidos
  contenidoFisico  String @db.Text
  contenidoTecnico String @db.Text
  contenidoTactico String @db.Text

  // Estructura de sesión
  calentamiento  String? @db.Text
  partePrincipal String? @db.Text
  vueltaCalma    String? @db.Text

  // Observaciones
  observaciones     String? @db.Text
  materialNecesario String? @db.Text

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relaciones
  microciclo                 Microciclo                  @relation(fields: [microcicloId], references: [id], onDelete: Cascade)
  sesionBase                 Sesion?                     @relation("SesionAjustes", fields: [sesionBaseId], references: [id])
  ajustesGenerados           Sesion[]                    @relation("SesionAjustes")
  registrosPostEntrenamiento RegistroPostEntrenamiento[]
  testsFisicos               TestFisico[]
  recomendacionesGeneradas   Recomendacion[]

  @@index([microcicloId])
  @@index([fecha])
  @@index([sesionBaseId])
  @@map("sesiones")
}

// ===================================
// GRUPO 3: TESTS FÍSICOS
// ===================================

model TestFisico {
  id                   BigInt   @id @default(autoincrement())
  atletaId             BigInt
  entrenadorRegistroId BigInt
  sesionId             BigInt?
  fechaTest            DateTime @db.Date
  microcicloId         BigInt?

  // Tests de fuerza máxima (1RM)
  pressBanca           Decimal? @db.Decimal(5, 2)
  pressBancaIntensidad Decimal? @db.Decimal(5, 2)
  tiron                Decimal? @db.Decimal(5, 2)
  tironIntensidad      Decimal? @db.Decimal(5, 2)
  sentadilla           Decimal? @db.Decimal(5, 2)
  sentadillaIntensidad Decimal? @db.Decimal(5, 2)

  // Tests de fuerza resistencia
  barraFija Int?
  paralelas Int?

  // Tests de resistencia aeróbica
  navettePalier   Decimal?  @db.Decimal(5, 2)
  navetteVO2max   Decimal?  @db.Decimal(5, 2)
  test1500m       DateTime? @db.Time
  test1500mVO2max Decimal?  @db.Decimal(5, 2)

  // Observaciones
  observaciones   String? @db.Text
  condicionesTest String? @db.Text

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relaciones
  atleta          Atleta          @relation(fields: [atletaId], references: [id], onDelete: Cascade)
  entrenador      Entrenador      @relation(fields: [entrenadorRegistroId], references: [id])
  sesion          Sesion?         @relation(fields: [sesionId], references: [id])
  microciclo      Microciclo?     @relation(fields: [microcicloId], references: [id])
  recomendaciones Recomendacion[]

  @@index([atletaId])
  @@index([entrenadorRegistroId])
  @@index([sesionId])
  @@index([microcicloId])
  @@index([fechaTest])
  @@map("tests_fisicos")
}

// ===================================
// GRUPO 4: REGISTRO POST-ENTRENAMIENTO
// ===================================

model RegistroPostEntrenamiento {
  id                   BigInt   @id @default(autoincrement())
  atletaId             BigInt
  sesionId             BigInt
  entrenadorRegistroId BigInt
  fechaRegistro        DateTime @default(now())

  // Asistencia
  asistio            Boolean
  motivoInasistencia String? @db.Text

  // Ejecución de la sesión
  ejerciciosCompletados Decimal @db.Decimal(5, 2)
  intensidadAlcanzada   Decimal @db.Decimal(5, 2)
  duracionReal          Int

  // RPE (Rate of Perceived Exertion)
  rpe Int

  // Recuperación
  calidadSueno Int
  horasSueno   Decimal? @db.Decimal(3, 1)

  // Estado anímico
  estadoAnimico Int

  // Observaciones
  observaciones String? @db.Text

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relaciones
  atleta          Atleta          @relation(fields: [atletaId], references: [id], onDelete: Cascade)
  sesion          Sesion          @relation(fields: [sesionId], references: [id])
  entrenador      Entrenador      @relation(fields: [entrenadorRegistroId], references: [id])
  dolencias       Dolencia[]
  recomendaciones Recomendacion[]

  @@index([atletaId])
  @@index([sesionId])
  @@index([entrenadorRegistroId])
  @@index([fechaRegistro])
  @@map("registros_post_entrenamiento")
}

model Dolencia {
  id                          BigInt      @id @default(autoincrement())
  registroPostEntrenamientoId BigInt
  zona                        String      @db.VarChar(100)
  nivel                       Int
  descripcion                 String?     @db.Text
  tipoLesion                  TipoLesion?

  // Campos de recuperación (Fase 4)
  recuperado        Boolean   @default(false)
  fechaRecuperacion DateTime?
  recuperadoPor     BigInt?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relaciones
  registroPostEntrenamiento RegistroPostEntrenamiento @relation(fields: [registroPostEntrenamientoId], references: [id], onDelete: Cascade)
  entrenadorRecuperacion    Entrenador?               @relation("DolenciaRecuperacion", fields: [recuperadoPor], references: [id])

  @@index([registroPostEntrenamientoId])
  @@index([recuperado])
  @@index([recuperadoPor])
  @@map("dolencias")
}

// ===================================
// GRUPO 5: ALGORITMO DE RECOMENDACIÓN
// ===================================

model Recomendacion {
  id                   BigInt            @id @default(autoincrement())
  atletaId             BigInt
  microcicloAfectadoId BigInt?
  tipo                 TipoRecomendacion
  prioridad            Prioridad
  titulo               String            @db.VarChar(255)
  mensaje              String            @db.Text
  datosAnalisis        Json?
  accionSugerida       String?           @db.Text
  sesionesAfectadas    Json?

  // Nuevos campos (audio.txt)
  generoPlanificacion Boolean             @default(false)
  sesionGeneradaId    BigInt?
  estado              EstadoRecomendacion @default(PENDIENTE)

  // Respuesta del Comité Técnico
  revisadoPor        BigInt?
  fechaRevision      DateTime?
  comentarioRevision String?   @db.Text

  // Aplicación
  aplicadoPor     BigInt?
  fechaAplicacion DateTime?

  // Trigger
  registroPostEntrenamientoId BigInt?
  testFisicoId                BigInt?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relaciones
  atleta                    Atleta                     @relation(fields: [atletaId], references: [id], onDelete: Cascade)
  microcicloAfectado        Microciclo?                @relation(fields: [microcicloAfectadoId], references: [id])
  sesionGenerada            Sesion?                    @relation(fields: [sesionGeneradaId], references: [id])
  revisor                   Usuario?                   @relation("RecomendacionRevisada", fields: [revisadoPor], references: [id])
  aplicador                 Usuario?                   @relation("RecomendacionAplicada", fields: [aplicadoPor], references: [id])
  registroPostEntrenamiento RegistroPostEntrenamiento? @relation(fields: [registroPostEntrenamientoId], references: [id])
  testFisico                TestFisico?                @relation(fields: [testFisicoId], references: [id])
  notificaciones            Notificacion[]

  @@index([atletaId])
  @@index([microcicloAfectadoId])
  @@index([sesionGeneradaId])
  @@index([revisadoPor])
  @@index([aplicadoPor])
  @@index([registroPostEntrenamientoId])
  @@index([testFisicoId])
  @@index([estado])
  @@index([prioridad])
  @@map("recomendaciones")
}

model Notificacion {
  id              BigInt           @id @default(autoincrement())
  destinatarioId  BigInt
  recomendacionId BigInt?
  tipo            TipoNotificacion
  titulo          String           @db.VarChar(255)
  mensaje         String           @db.Text
  leida           Boolean          @default(false)
  fechaLeida      DateTime?
  prioridad       Prioridad        @default(MEDIA)
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt

  // Relaciones
  destinatario  Usuario        @relation(fields: [destinatarioId], references: [id], onDelete: Cascade)
  recomendacion Recomendacion? @relation(fields: [recomendacionId], references: [id])

  @@index([destinatarioId, leida])
  @@index([recomendacionId])
  @@map("notificaciones")
}

// ===================================
// GRUPO 6: ALERTAS Y CONFIGURACIÓN
// ===================================

model AlertaSistema {
  id             BigInt     @id @default(autoincrement())
  atletaId       BigInt
  destinatarioId BigInt
  tipo           TipoAlerta
  titulo         String     @db.VarChar(255)
  descripcion    String     @db.Text
  severidad      Severidad
  leida          Boolean    @default(false)
  fechaLeida     DateTime?
  datosContexto  Json?
  createdAt      DateTime   @default(now())

  // Relaciones
  atleta       Atleta  @relation(fields: [atletaId], references: [id], onDelete: Cascade)
  destinatario Usuario @relation(fields: [destinatarioId], references: [id])

  @@index([destinatarioId, leida])
  @@index([atletaId])
  @@index([tipo])
  @@map("alertas_sistema")
}

model ToleranciasPeso {
  id                BigInt            @id @default(autoincrement())
  categoriaPeso     String            @db.VarChar(10)
  periodo           PeriodoTolerancia
  toleranciaLunes   Decimal           @db.Decimal(4, 2)
  toleranciaViernes Decimal           @db.Decimal(4, 2)
  createdAt         DateTime          @default(now())
  updatedAt         DateTime          @updatedAt

  @@unique([categoriaPeso, periodo])
  @@map("tolerancias_peso")
}

model CatalogoEjercicios {
  id                BigInt        @id @default(autoincrement())
  nombre            String        @db.VarChar(255)
  tipo              TipoEjercicio
  subtipo           String?       @db.VarChar(100)
  categoria         String?       @db.VarChar(50)
  descripcion       String?       @db.Text
  instrucciones     String?       @db.Text
  materialNecesario String?       @db.Text

  // Nuevos campos (ejerc_fisico.txt, nomenclatura.txt)
  duracionMinutos    Int?
  intensidadSugerida Decimal? @db.Decimal(5, 2)
  sistemaEnergetico  String?  @db.VarChar(50)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([tipo])
  @@index([subtipo])
  @@map("catalogo_ejercicios")
}

model Baremos {
  id            BigInt   @id @default(autoincrement())
  tipo          String   @db.VarChar(20)
  nivel         Int      @db.SmallInt
  porcentajeMin Decimal  @db.Decimal(5, 2)
  porcentajeMax Decimal  @db.Decimal(5, 2)
  minutosMin    Int?
  minutosMax    Int?
  fcMin         Int?
  fcMax         Int?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@unique([tipo, nivel])
  @@index([tipo])
  @@index([nivel])
  @@map("baremos")
}

model Nomenclatura {
  id                BigInt   @id @default(autoincrement())
  codigo            String   @unique @db.VarChar(20)
  nombreCompleto    String   @db.VarChar(100)
  categoria         String   @db.VarChar(50)
  descripcion       String?  @db.Text
  wintPercent       Decimal? @db.Decimal(5, 2)
  sistemaEnergetico String?  @db.VarChar(50)
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@index([codigo])
  @@index([categoria])
  @@map("nomenclatura")
}

model ZonaEsfuerzo {
  id             BigInt   @id @default(autoincrement())
  codigo         String   @unique @db.VarChar(50)
  nombreCompleto String   @db.VarChar(100)
  categoria      String   @db.VarChar(50)
  wintPercent    Decimal? @db.Decimal(5, 2)
  descripcion    String?  @db.Text
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@index([codigo])
  @@index([categoria])
  @@map("zonas_esfuerzo")
}

// ===================================
// GRUPO 7: ASIGNACIONES
// ===================================

model AsignacionAtletaMicrociclo {
  id              BigInt   @id @default(autoincrement())
  atletaId        BigInt
  microcicloId    BigInt
  asignadoPor     BigInt
  fechaAsignacion DateTime @default(now())
  activa          Boolean  @default(true)
  observaciones   String?  @db.Text
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  // Relaciones
  atleta     Atleta     @relation(fields: [atletaId], references: [id], onDelete: Cascade)
  microciclo Microciclo @relation(fields: [microcicloId], references: [id], onDelete: Cascade)
  asignador  Usuario    @relation(fields: [asignadoPor], references: [id])

  @@unique([atletaId, microcicloId])
  @@index([atletaId])
  @@index([microcicloId])
  @@index([asignadoPor])
  @@map("asignaciones_atleta_microciclo")
}

// ===================================
// GRUPO 8: SEGURIDAD Y AUDITORÍA
// ===================================

model ResetPassword {
  id        BigInt   @id @default(autoincrement())
  usuarioId BigInt
  token     String   @unique @db.VarChar(255)
  expiraEn  DateTime
  usado     Boolean  @default(false)
  createdAt DateTime @default(now())

  // Relaciones
  usuario Usuario @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  @@index([token])
  @@index([usuarioId])
  @@map("reset_passwords")
}

model AuditoriaAcceso {
  id        BigInt   @id @default(autoincrement())
  usuarioId BigInt?
  accion    String   @db.VarChar(100)
  ip        String   @db.VarChar(45)
  userAgent String   @db.Text
  exito     Boolean
  createdAt DateTime @default(now())

  // Relaciones
  usuario Usuario? @relation(fields: [usuarioId], references: [id], onDelete: SetNull)

  @@index([usuarioId])
  @@index([createdAt])
  @@map("auditorias_acceso")
}
